FROM n8nio/n8n:2.0.2

ENV NODE_OPTIONS=--max_old_space_size=768
# Timezone
ENV GENERIC_TIMEZONE=Asia/Kolkata
# Redis
ENV QUEUE_BULL_PREFIX=n8n-
ENV QUEUE_BULL_REDIS_HOST=redis
ENV QUEUE_BULL_REDIS_PORT=6379
# Encryption 
ENV N8N_ENCRYPTION_KEY=YOUR_ENCRYPTION_KEY_HERE


# Database
ENV DB_TYPE=postgresdb
ENV DB_POSTGRESDB_HOST=postgres
ENV DB_POSTGRESDB_PORT=5432
ENV DB_POSTGRESDB_DATABASE=n8n
ENV DB_POSTGRESDB_USER=postgres_name
ENV DB_POSTGRESDB_PASSWORD=postgres_pasword
ENV DB_POSTGRESDB_SSL_REJECT_UNAUTHORIZED=true
ENV DB_POSTGRESDB_POOL_SIZE=50
ENV DB_POSTGRESDB_CONNECTION_TIMEOUT=30000
ENV DB_POSTGRESDB_IDLE_TIMEOUT=40000

# Workflow
ENV WORKFLOWS_DEFAULT_NAME=n8n-{{DATE}}


# Workflow Node settings
ENV NODES_EXCLUDE=n8n-nodes-base.gmail


# Execution
ENV EXECUTIONS_MODE=queue
ENV EXECUTIONS_DATA_PRUNE=true
ENV EXECUTIONS_DATA_MAX_AGE=168
ENV EXECUTIONS_DATA_PRUNE_MAX_COUNT=50000
ENV EXECUTIONS_TIMEOUT_MAX=1500
ENV EXECUTIONS_DATA_SAVE_ON_ERROR=all
ENV EXECUTIONS_DATA_SAVE_ON_SUCCESS=all
ENV EXECUTIONS_DATA_SAVE_ON_PROGRESS=true
ENV EXECUTIONS_DATA_SAVE_MANUAL_EXECUTIONS=true
ENV EXECUTIONS_DATA_MAX_AGE=744
# Queue
ENV QUEUE_WORKER_LOCK_DURATION=60000
ENV QUEUE_WORKER_LOCK_RENEW_TIME=30000
ENV QUEUE_WORKER_STALLED_INTERVAL=60000
# Endpoint
ENV WEBHOOK_URL=https://your-domain.com
ENV N8N_METRICS=true
ENV N8N_DISABLE_PRODUCTION_MAIN_PROCESS=true
# User management
ENV N8N_EMAIL_MODE=smtp
ENV N8N_SMTP_HOST=smtp.example.com
ENV N8N_SMTP_PORT=587
ENV N8N_SMTP_USER=YOUR_SMTP_USER
ENV N8N_SMTP_PASS=YOUR_SMTP_PASSWORD
ENV N8N_SMTP_SENDER=your-email@example.com
ENV N8N_SMTP_SSL=false

# Log level
ENV N8N_LOG_LEVEL=info


EXPOSE 5678:5678
